# Maintainer: Matthew Skala <@PACKAGE_BUGREPORT@>
pkgname=@PACKAGE_TARNAME@
pkgver=@pkgbuild_version@
pkgrel=1
pkgdesc="A tool for finding Japanese kanji according to their structure."
arch=('any')
url="@PACKAGE_URL@"
license=('GPL3')
groups=()
depends=()
makedepends=('expect' 'fontforge' 'grep' 'perl' 'swi-prolog' 'texlive-core')
checkdepends=()
optdepends=()
provides=()
conflicts=()
replaces=()
backup=()
options=()
# install=
# changelog=
source=("https://github.com/downloads/mskala/Tsukurimashou/$pkgname-$pkgver.tar.gz"
  "https://github.com/downloads/mskala/Tsukurimashou/tsukurimashou-@pkgbuild_tsu_version@.zip"
  'http://ftp.monash.edu.au/pub/nihongo/edict2.gz'
  'https://github.com/downloads/KanjiVG/kanjivg/@kanjivg_filename@')
noextract=(edict2.gz @kanjivg_filename@)
@checksum_type@s=('@distsum_idsgrep@'
  '@distsum_tsuku@'
  '@distsum_ed@'
  '@distsum_kvg@')

build() {
  cd "$srcdir/tsukurimashou-@pkgbuild_tsu_version@"
  ./configure --enable-ot-features=all
  cd ..
  cd "$srcdir/$pkgname-$pkgver"
  ./configure --prefix=/usr --with-edict2=../edict2.gz \
    --with-kanjivg=../@kanjivg_filename@ \
    --with-tsuku-build=../tsukurimashou-@pkgbuild_tsu_version@
  make
}

check() {
  cd "$srcdir/$pkgname-$pkgver"
  make -k check
}

package() {
  cd "$srcdir/$pkgname-$pkgver"
  make DESTDIR="$pkgdir/" install
}
